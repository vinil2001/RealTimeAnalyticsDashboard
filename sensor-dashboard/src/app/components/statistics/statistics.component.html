<div *ngIf="statistics.length === 0" class="text-center text-muted py-4">
  <i class="fas fa-chart-bar fa-2x mb-2"></i>
  <p>No statistics available</p>
</div>

<div class="row" *ngIf="statistics.length > 0">
  <div class="col-12" *ngFor="let stats of statistics; trackBy: trackByStats">
    <div class="card mb-3 sensor-stats-card">
      <div class="card-body">
        <div class="row align-items-center">
          <!-- Sensor Info -->
          <div class="col-md-3">
            <div class="d-flex align-items-center">
              <i [class]="getSensorTypeIcon(stats.type) + ' ' + getSensorTypeColor(stats.type)" 
                 class="fa-lg me-3"></i>
              <div>
                <h6 class="mb-0">{{ stats.sensorId }}</h6>
                <small class="text-muted">{{ getSensorTypeName(stats.type) }}</small>
              </div>
            </div>
          </div>

          <!-- Statistics -->
          <div class="col-md-6">
            <div class="row text-center">
              <div class="col-3">
                <div class="stat-item">
                  <div class="stat-value text-primary">{{ formatNumber(stats.averageValue) }}</div>
                  <div class="stat-label">Average</div>
                </div>
              </div>
              <div class="col-3">
                <div class="stat-item">
                  <div class="stat-value text-success">{{ formatNumber(stats.minValue) }}</div>
                  <div class="stat-label">Min</div>
                </div>
              </div>
              <div class="col-3">
                <div class="stat-item">
                  <div class="stat-value text-danger">{{ formatNumber(stats.maxValue) }}</div>
                  <div class="stat-label">Max</div>
                </div>
              </div>
              <div class="col-3">
                <div class="stat-item">
                  <div class="stat-value text-info">{{ stats.count | number }}</div>
                  <div class="stat-label">Count</div>
                </div>
              </div>
            </div>
          </div>

          <!-- Status -->
          <div class="col-md-3">
            <div class="text-end">
              <div class="mb-2">
                <span class="badge" [class]="'bg-' + getHealthStatus(stats).class.split('-')[1]">
                  {{ getHealthStatus(stats).status }}
                </span>
              </div>
              <div class="mb-2">
                <span class="badge" [class]="'bg-' + getVariabilityLevel(stats.standardDeviation, stats.averageValue).class.split('-')[1]">
                  {{ getVariabilityLevel(stats.standardDeviation, stats.averageValue).level }}
                </span>
              </div>
              <small class="text-muted d-block">
                Updated {{ stats.lastUpdate | timeAgo:((timeTracker.currentTime$ | async) || 0) }}
              </small>
            </div>
          </div>
        </div>

        <!-- Standard Deviation Bar -->
        <div class="row mt-3">
          <div class="col-12">
            <div class="d-flex align-items-center">
              <small class="text-muted me-2">Std Dev:</small>
              <div class="flex-grow-1">
                <div class="progress" style="height: 4px;">
                  <div class="progress-bar" 
                       [class]="getVariabilityLevel(stats.standardDeviation, stats.averageValue).class.replace('text-', 'bg-')"
                       [style.width.%]="Math.min((stats.standardDeviation / stats.averageValue) * 100, 100)">
                  </div>
                </div>
              </div>
              <small class="text-muted ms-2">{{ formatNumber(stats.standardDeviation) }}</small>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
