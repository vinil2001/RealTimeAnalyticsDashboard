# üöÄ Production Deployment Guide

## Overview
Deploy Real-Time Analytics Dashboard to free hosting platforms:
- **Backend**: Railway (with PostgreSQL)
- **Frontend**: Netlify (with GitHub auto-deploy)
- **Domain**: Free subdomains from both platforms

## üìã Prerequisites

1. **GitHub Account** - for code repository
2. **Railway Account** - sign up at [railway.app](https://railway.app)
3. **Netlify Account** - sign up at [netlify.com](https://netlify.com)

## üîß Step 1: Prepare Repository

### Push to GitHub
```bash
# Initialize git (if not already done)
git init
git add .
git commit -m "Initial commit: Real-Time Analytics Dashboard"

# Create repository on GitHub and push
git branch -M main
git remote add origin https://github.com/YOUR_USERNAME/RealTimeAnalyticsDashboard.git
git push -u origin main
```

## üêò Step 2: Deploy Backend to Railway

### 2.1 Create Railway Project
1. Go to [railway.app](https://railway.app)
2. Click **"Start a New Project"**
3. Select **"Deploy from GitHub repo"**
4. Choose your `RealTimeAnalyticsDashboard` repository
5. Railway will auto-detect the .NET project

### 2.2 Add PostgreSQL Database
1. In your Railway project dashboard
2. Click **"+ New Service"**
3. Select **"Database" ‚Üí "PostgreSQL"**
4. Railway will automatically create `DATABASE_URL` environment variable

### 2.3 Configure Environment Variables
In Railway project settings, add:
```bash
# Auto-generated by Railway
DATABASE_URL=postgresql://username:password@host:port/database

# Set by Railway automatically
PORT=8080

# Add manually
ASPNETCORE_ENVIRONMENT=Production
FRONTEND_URL=https://YOUR_NETLIFY_SUBDOMAIN.netlify.app
```

### 2.4 Deploy
1. Railway will automatically build and deploy
2. Get your backend URL: `https://YOUR_PROJECT.up.railway.app`
3. Test health endpoint: `https://YOUR_PROJECT.up.railway.app/health`

## üåê Step 3: Deploy Frontend to Netlify

### 3.1 Update Production Environment
Update `sensor-dashboard/src/environments/environment.prod.ts`:
```typescript
export const environment = {
  production: true,
  apiUrl: 'https://YOUR_RAILWAY_PROJECT.up.railway.app/api',
  signalRUrl: 'https://YOUR_RAILWAY_PROJECT.up.railway.app/sensorHub'
};
```

### 3.2 Create Netlify Project
1. Go to [netlify.com](https://netlify.com)
2. Click **"Add new site" ‚Üí "Import an existing project"**
3. Connect to GitHub and select your repository
4. Configure build settings:
   - **Base directory**: `sensor-dashboard`
   - **Build command**: `npm ci && npm run build --configuration=production`
   - **Publish directory**: `sensor-dashboard/dist/sensor-dashboard`

### 3.3 Configure Environment Variables
In Netlify site settings ‚Üí Environment variables:
```bash
NODE_VERSION=18
NPM_VERSION=9
```

### 3.4 Update Backend CORS
Update Railway environment variable:
```bash
FRONTEND_URL=https://YOUR_NETLIFY_SUBDOMAIN.netlify.app
```

## üîÑ Step 4: Enable Auto-Deploy

### GitHub Integration
Both platforms automatically deploy on git push:
- **Railway**: Deploys backend on push to `main`
- **Netlify**: Deploys frontend on push to `main`

### Branch Protection (Optional)
```bash
# Create production branch
git checkout -b production
git push -u origin production

# Configure Railway/Netlify to deploy from 'production' branch
```

## üìä Step 5: Verify Deployment

### Backend Health Check
```bash
curl https://YOUR_RAILWAY_PROJECT.up.railway.app/health
```

Expected response:
```json
{
  "status": "healthy",
  "timestamp": "2025-10-08T10:00:00.000Z",
  "environment": "Production",
  "database": "PostgreSQL"
}
```

### Frontend Test
1. Visit: `https://YOUR_NETLIFY_SUBDOMAIN.netlify.app`
2. Check connection status: Should show "Connected"
3. Verify real-time data updates
4. Test all dashboard features

## üîß Troubleshooting

### Common Issues

#### Backend Issues
```bash
# Check Railway logs
railway logs

# Test database connection
railway run dotnet ef database update
```

#### Frontend Issues
```bash
# Check Netlify deploy logs
# Verify CORS settings in Railway
# Check browser console for errors
```

#### CORS Errors
Make sure Railway `FRONTEND_URL` matches Netlify domain exactly:
```bash
# Railway environment
FRONTEND_URL=https://realtimeanalytics-dashboard.netlify.app

# No trailing slash!
```

## üìà Monitoring

### Railway Metrics
- CPU/Memory usage
- Request logs
- Database connections

### Netlify Analytics
- Page views
- Build status
- Performance metrics

## üîÑ Updates

### Deploy Updates
```bash
# Make changes
git add .
git commit -m "Update: description"
git push origin main

# Both platforms auto-deploy
```

### Database Migrations
```bash
# Connect to Railway and run migrations
railway run dotnet ef database update
```

## üí∞ Cost Optimization

### Railway Free Tier
- 512MB RAM
- 1GB disk
- $5 credit monthly
- Sleeps after 30min inactivity

### Netlify Free Tier
- 100GB bandwidth
- 300 build minutes
- Unlimited sites

### Tips
- Use Railway sleep mode for development
- Optimize bundle size for faster deploys
- Monitor usage in dashboards

## üéØ Production URLs

After deployment, your app will be available at:
- **Frontend**: `https://YOUR_NETLIFY_SUBDOMAIN.netlify.app`
- **Backend API**: `https://YOUR_RAILWAY_PROJECT.up.railway.app/api`
- **Health Check**: `https://YOUR_RAILWAY_PROJECT.up.railway.app/health`

## üîê Security Considerations

1. **Environment Variables**: Never commit secrets to git
2. **HTTPS Only**: Both platforms provide SSL certificates
3. **CORS**: Properly configured for production domains
4. **Database**: Railway PostgreSQL is secure by default

Ready to deploy! üöÄ
